function cov_1dw3cj728y(){var path="/home/marcgm97/bootcamp/collab/skylab-bootcamp-202004/staff/marc-guillemas/qrmenu/qrmenu-server-logic/retrieve-orders.js";var hash="d10ed6a27775889128b371041f7cfc0cf6f42a99";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/marcgm97/bootcamp/collab/skylab-bootcamp-202004/staff/marc-guillemas/qrmenu/qrmenu-server-logic/retrieve-orders.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:45}},"1":{start:{line:2,column:34},end:{line:2,column:56}},"2":{start:{line:3,column:37},end:{line:3,column:62}},"3":{start:{line:10,column:0},end:{line:37,column:1}},"4":{start:{line:12,column:4},end:{line:12,column:44}},"5":{start:{line:13,column:4},end:{line:13,column:37}},"6":{start:{line:15,column:4},end:{line:36,column:8}},"7":{start:{line:16,column:30},end:{line:16,column:75}},"8":{start:{line:18,column:8},end:{line:18,column:112}},"9":{start:{line:18,column:27},end:{line:18,column:112}},"10":{start:{line:20,column:32},end:{line:20,column:45}},"11":{start:{line:22,column:23},end:{line:22,column:81}},"12":{start:{line:22,column:45},end:{line:22,column:80}},"13":{start:{line:24,column:8},end:{line:24,column:91}},"14":{start:{line:24,column:20},end:{line:24,column:91}},"15":{start:{line:26,column:8},end:{line:26,column:80}},"16":{start:{line:26,column:27},end:{line:26,column:80}},"17":{start:{line:28,column:22},end:{line:28,column:24}},"18":{start:{line:30,column:8},end:{line:33,column:10}},"19":{start:{line:31,column:12},end:{line:32,column:35}},"20":{start:{line:32,column:16},end:{line:32,column:35}},"21":{start:{line:35,column:8},end:{line:35,column:22}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:10,column:17},end:{line:10,column:18}},loc:{start:{line:10,column:48},end:{line:37,column:1}},line:10},"1":{name:"(anonymous_1)",decl:{start:{line:15,column:12},end:{line:15,column:13}},loc:{start:{line:15,column:23},end:{line:36,column:5}},line:15},"2":{name:"(anonymous_2)",decl:{start:{line:22,column:34},end:{line:22,column:35}},loc:{start:{line:22,column:45},end:{line:22,column:80}},line:22},"3":{name:"(anonymous_3)",decl:{start:{line:30,column:23},end:{line:30,column:24}},loc:{start:{line:30,column:34},end:{line:33,column:9}},line:30}},branchMap:{"0":{loc:{start:{line:18,column:8},end:{line:18,column:112}},type:"if",locations:[{start:{line:18,column:8},end:{line:18,column:112}},{start:{line:18,column:8},end:{line:18,column:112}}],line:18},"1":{loc:{start:{line:24,column:8},end:{line:24,column:91}},type:"if",locations:[{start:{line:24,column:8},end:{line:24,column:91}},{start:{line:24,column:8},end:{line:24,column:91}}],line:24},"2":{loc:{start:{line:26,column:8},end:{line:26,column:80}},type:"if",locations:[{start:{line:26,column:8},end:{line:26,column:80}},{start:{line:26,column:8},end:{line:26,column:80}}],line:26},"3":{loc:{start:{line:31,column:12},end:{line:32,column:35}},type:"if",locations:[{start:{line:31,column:12},end:{line:32,column:35}},{start:{line:31,column:12},end:{line:32,column:35}}],line:31}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"d10ed6a27775889128b371041f7cfc0cf6f42a99"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1dw3cj728y=function(){return actualCoverage;};}return actualCoverage;}cov_1dw3cj728y();cov_1dw3cj728y().s[0]++;require('../qrmenu-commons/polyfills/string');const{models:{Establishment}}=(cov_1dw3cj728y().s[1]++,require('qrmenu-data'));const{errors:{UnexistenceError}}=(cov_1dw3cj728y().s[2]++,require('qrmenu-commons'));/**
 * 
 * @param {string} establishmentId id of the establishment
 * @param {string} workerId id of the worker
 */cov_1dw3cj728y().s[3]++;module.exports=(establishmentId,workerId)=>{cov_1dw3cj728y().f[0]++;cov_1dw3cj728y().s[4]++;String.validate.notVoid(establishmentId);cov_1dw3cj728y().s[5]++;String.validate.notVoid(workerId);cov_1dw3cj728y().s[6]++;return(async()=>{cov_1dw3cj728y().f[1]++;const establishment=(cov_1dw3cj728y().s[7]++,await Establishment.findById(establishmentId));cov_1dw3cj728y().s[8]++;if(!establishment){cov_1dw3cj728y().b[0][0]++;cov_1dw3cj728y().s[9]++;throw new UnexistenceError(`Establishment with id ${establishmentId} does not exist`);}else{cov_1dw3cj728y().b[0][1]++;}const{staff,orders}=(cov_1dw3cj728y().s[10]++,establishment);const worker=(cov_1dw3cj728y().s[11]++,staff.find(_worker=>{cov_1dw3cj728y().f[2]++;cov_1dw3cj728y().s[12]++;return _worker._id.toString()===workerId;}));cov_1dw3cj728y().s[13]++;if(!worker){cov_1dw3cj728y().b[1][0]++;cov_1dw3cj728y().s[14]++;throw new UnexistenceError(`worker with id ${workerId} does not exist`);}else{cov_1dw3cj728y().b[1][1]++;}cov_1dw3cj728y().s[15]++;if(!orders.length){cov_1dw3cj728y().b[2][0]++;cov_1dw3cj728y().s[16]++;throw new UnexistenceError('there are no orders yet');}else{cov_1dw3cj728y().b[2][1]++;}let _orders=(cov_1dw3cj728y().s[17]++,[]);cov_1dw3cj728y().s[18]++;orders.forEach(order=>{cov_1dw3cj728y().f[3]++;cov_1dw3cj728y().s[19]++;if(!order.payed){cov_1dw3cj728y().b[3][0]++;cov_1dw3cj728y().s[20]++;_orders.push(order);}else{cov_1dw3cj728y().b[3][1]++;}});cov_1dw3cj728y().s[21]++;return _orders;})();};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJldHJpZXZlLW9yZGVycy5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlIiwibW9kZWxzIiwiRXN0YWJsaXNobWVudCIsImVycm9ycyIsIlVuZXhpc3RlbmNlRXJyb3IiLCJtb2R1bGUiLCJleHBvcnRzIiwiZXN0YWJsaXNobWVudElkIiwid29ya2VySWQiLCJTdHJpbmciLCJ2YWxpZGF0ZSIsIm5vdFZvaWQiLCJlc3RhYmxpc2htZW50IiwiZmluZEJ5SWQiLCJzdGFmZiIsIm9yZGVycyIsIndvcmtlciIsImZpbmQiLCJfd29ya2VyIiwiX2lkIiwidG9TdHJpbmciLCJsZW5ndGgiLCJfb3JkZXJzIiwiZm9yRWFjaCIsIm9yZGVyIiwicGF5ZWQiLCJwdXNoIl0sIm1hcHBpbmdzIjoiNjhHQWVZO21IQWZaQSxPQUFPLENBQUMsb0NBQUQsQ0FBUCxDQUNBLEtBQU0sQ0FBQ0MsTUFBTSxDQUFFLENBQUNDLGFBQUQsQ0FBVCwyQkFBNEJGLE9BQU8sQ0FBQyxhQUFELENBQW5DLENBQU4sQ0FDQSxLQUFNLENBQUNHLE1BQU0sQ0FBRSxDQUFDQyxnQkFBRCxDQUFULDJCQUErQkosT0FBTyxDQUFDLGdCQUFELENBQXRDLENBQU4sQ0FDQTs7OzsyQkFNQUssTUFBTSxDQUFDQyxPQUFQLENBQWlCLENBQUNDLGVBQUQsQ0FBa0JDLFFBQWxCLEdBQStCLGlEQUU1Q0MsTUFBTSxDQUFDQyxRQUFQLENBQWdCQyxPQUFoQixDQUF3QkosZUFBeEIsRUFGNEMsd0JBRzVDRSxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JDLE9BQWhCLENBQXdCSCxRQUF4QixFQUg0Qyx3QkFLNUMsTUFBTyxDQUFDLFNBQVcseUJBQ2YsS0FBTUksQ0FBQUEsYUFBYSwwQkFBRyxLQUFNVixDQUFBQSxhQUFhLENBQUNXLFFBQWQsQ0FBdUJOLGVBQXZCLENBQVQsQ0FBbkIsQ0FEZSx3QkFHZixHQUFHLENBQUNLLGFBQUosQ0FBbUIseURBQU0sSUFBSVIsQ0FBQUEsZ0JBQUosQ0FBc0IseUJBQXdCRyxlQUFnQixpQkFBOUQsQ0FBTixDQUFxRixDQUF4RyxpQ0FFQSxLQUFNLENBQUNPLEtBQUQsQ0FBUUMsTUFBUiw0QkFBa0JILGFBQWxCLENBQU4sQ0FFQSxLQUFNSSxDQUFBQSxNQUFNLDJCQUFHRixLQUFLLENBQUNHLElBQU4sQ0FBV0MsT0FBTyxFQUFJLHdEQUFBQSxDQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsUUFBWixLQUEyQlosUUFBM0IsQ0FBbUMsQ0FBekQsQ0FBSCxDQUFaLENBUGUseUJBU2YsR0FBRyxDQUFDUSxNQUFKLENBQVksMERBQU0sSUFBSVosQ0FBQUEsZ0JBQUosQ0FBc0Isa0JBQWlCSSxRQUFTLGlCQUFoRCxDQUFOLENBQXVFLENBQW5GLGlDQVRlLHlCQVdmLEdBQUcsQ0FBQ08sTUFBTSxDQUFDTSxNQUFYLENBQW1CLDBEQUFNLElBQUlqQixDQUFBQSxnQkFBSixDQUFxQix5QkFBckIsQ0FBTixDQUFxRCxDQUF4RSxpQ0FFQSxHQUFJa0IsQ0FBQUEsT0FBTywyQkFBRyxFQUFILENBQVgsQ0FiZSx5QkFlZlAsTUFBTSxDQUFDUSxPQUFQLENBQWdCQyxLQUFELEVBQVcsa0RBQ3RCLEdBQUcsQ0FBQ0EsS0FBSyxDQUFDQyxLQUFWLENBQ0kscURBQUFILE9BQU8sQ0FBQ0ksSUFBUixDQUFhRixLQUFiLEVBQW1CLENBRHZCLGlDQUVILENBSEQsRUFmZSx5QkFvQmYsTUFBT0YsQ0FBQUEsT0FBUCxDQUNILENBckJNLEdBQVAsQ0FzQkgsQ0EzQkQiLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuLi9xcm1lbnUtY29tbW9ucy9wb2x5ZmlsbHMvc3RyaW5nJylcbmNvbnN0IHttb2RlbHM6IHtFc3RhYmxpc2htZW50fX0gPSByZXF1aXJlKCdxcm1lbnUtZGF0YScpXG5jb25zdCB7ZXJyb3JzOiB7VW5leGlzdGVuY2VFcnJvcn19ID0gcmVxdWlyZSgncXJtZW51LWNvbW1vbnMnKVxuLyoqXG4gKiBcbiAqIEBwYXJhbSB7c3RyaW5nfSBlc3RhYmxpc2htZW50SWQgaWQgb2YgdGhlIGVzdGFibGlzaG1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSB3b3JrZXJJZCBpZCBvZiB0aGUgd29ya2VyXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSAoZXN0YWJsaXNobWVudElkLCB3b3JrZXJJZCkgPT4ge1xuICAgIFxuICAgIFN0cmluZy52YWxpZGF0ZS5ub3RWb2lkKGVzdGFibGlzaG1lbnRJZClcbiAgICBTdHJpbmcudmFsaWRhdGUubm90Vm9pZCh3b3JrZXJJZClcbiAgICBcbiAgICByZXR1cm4gKGFzeW5jKCkgPT4ge1xuICAgICAgICBjb25zdCBlc3RhYmxpc2htZW50ID0gYXdhaXQgRXN0YWJsaXNobWVudC5maW5kQnlJZChlc3RhYmxpc2htZW50SWQpIFxuICAgICAgICBcbiAgICAgICAgaWYoIWVzdGFibGlzaG1lbnQpIHRocm93IG5ldyBVbmV4aXN0ZW5jZUVycm9yKGBFc3RhYmxpc2htZW50IHdpdGggaWQgJHtlc3RhYmxpc2htZW50SWR9IGRvZXMgbm90IGV4aXN0YClcblxuICAgICAgICBjb25zdCB7c3RhZmYsIG9yZGVyc30gPSBlc3RhYmxpc2htZW50XG5cbiAgICAgICAgY29uc3Qgd29ya2VyID0gc3RhZmYuZmluZChfd29ya2VyID0+IF93b3JrZXIuX2lkLnRvU3RyaW5nKCkgPT09IHdvcmtlcklkKVxuXG4gICAgICAgIGlmKCF3b3JrZXIpIHRocm93IG5ldyBVbmV4aXN0ZW5jZUVycm9yKGB3b3JrZXIgd2l0aCBpZCAke3dvcmtlcklkfSBkb2VzIG5vdCBleGlzdGApXG5cbiAgICAgICAgaWYoIW9yZGVycy5sZW5ndGgpIHRocm93IG5ldyBVbmV4aXN0ZW5jZUVycm9yKCd0aGVyZSBhcmUgbm8gb3JkZXJzIHlldCcpXG5cbiAgICAgICAgbGV0IF9vcmRlcnMgPSBbXVxuXG4gICAgICAgIG9yZGVycy5mb3JFYWNoKChvcmRlcikgPT4ge1xuICAgICAgICAgICAgaWYoIW9yZGVyLnBheWVkKVxuICAgICAgICAgICAgICAgIF9vcmRlcnMucHVzaChvcmRlcilcbiAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gX29yZGVyc1xuICAgIH0pKClcbn0iXX0=