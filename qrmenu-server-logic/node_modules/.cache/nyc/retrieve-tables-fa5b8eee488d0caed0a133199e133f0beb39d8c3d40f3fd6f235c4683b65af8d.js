function cov_22l33pm8ek(){var path="/home/marcgm97/bootcamp/collab/skylab-bootcamp-202004/staff/marc-guillemas/qrmenu/qrmenu-server-logic/retrieve-tables.js";var hash="efab350ddf99691df8fe5f5ecceb4f746e581e1a";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/marcgm97/bootcamp/collab/skylab-bootcamp-202004/staff/marc-guillemas/qrmenu/qrmenu-server-logic/retrieve-tables.js",statementMap:{"0":{start:{line:1,column:41},end:{line:1,column:63}},"1":{start:{line:2,column:37},end:{line:2,column:62}},"2":{start:{line:3,column:0},end:{line:3,column:42}},"3":{start:{line:11,column:0},end:{line:32,column:1}},"4":{start:{line:13,column:4},end:{line:13,column:36}},"5":{start:{line:14,column:4},end:{line:14,column:29}},"6":{start:{line:16,column:4},end:{line:31,column:8}},"7":{start:{line:17,column:30},end:{line:17,column:75}},"8":{start:{line:19,column:8},end:{line:19,column:112}},"9":{start:{line:19,column:27},end:{line:19,column:112}},"10":{start:{line:21,column:32},end:{line:21,column:45}},"11":{start:{line:23,column:23},end:{line:23,column:81}},"12":{start:{line:23,column:45},end:{line:23,column:80}},"13":{start:{line:25,column:8},end:{line:25,column:91}},"14":{start:{line:25,column:20},end:{line:25,column:91}},"15":{start:{line:27,column:8},end:{line:27,column:80}},"16":{start:{line:27,column:27},end:{line:27,column:80}},"17":{start:{line:29,column:8},end:{line:29,column:21}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:11,column:17},end:{line:11,column:18}},loc:{start:{line:11,column:48},end:{line:32,column:1}},line:11},"1":{name:"(anonymous_1)",decl:{start:{line:16,column:12},end:{line:16,column:13}},loc:{start:{line:16,column:23},end:{line:31,column:5}},line:16},"2":{name:"(anonymous_2)",decl:{start:{line:23,column:34},end:{line:23,column:35}},loc:{start:{line:23,column:45},end:{line:23,column:80}},line:23}},branchMap:{"0":{loc:{start:{line:19,column:8},end:{line:19,column:112}},type:"if",locations:[{start:{line:19,column:8},end:{line:19,column:112}},{start:{line:19,column:8},end:{line:19,column:112}}],line:19},"1":{loc:{start:{line:25,column:8},end:{line:25,column:91}},type:"if",locations:[{start:{line:25,column:8},end:{line:25,column:91}},{start:{line:25,column:8},end:{line:25,column:91}}],line:25},"2":{loc:{start:{line:27,column:8},end:{line:27,column:80}},type:"if",locations:[{start:{line:27,column:8},end:{line:27,column:80}},{start:{line:27,column:8},end:{line:27,column:80}}],line:27}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"efab350ddf99691df8fe5f5ecceb4f746e581e1a"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_22l33pm8ek=function(){return actualCoverage;};}return actualCoverage;}cov_22l33pm8ek();const{models:{Establishment,Order}}=(cov_22l33pm8ek().s[0]++,require('qrmenu-data'));const{errors:{UnexistenceError}}=(cov_22l33pm8ek().s[1]++,require('qrmenu-commons'));cov_22l33pm8ek().s[2]++;require('qrmenu-commons/polyfills/string');/**
 * 
 * @param {string} establishmentId id of the establishment
 * @param {string} workerId id of the worker
 */cov_22l33pm8ek().s[3]++;module.exports=(establishmentId,workerId)=>{cov_22l33pm8ek().f[0]++;cov_22l33pm8ek().s[4]++;String.validate(establishmentId);cov_22l33pm8ek().s[5]++;String.validate(workerId);cov_22l33pm8ek().s[6]++;return(async()=>{cov_22l33pm8ek().f[1]++;const establishment=(cov_22l33pm8ek().s[7]++,await Establishment.findById(establishmentId));cov_22l33pm8ek().s[8]++;if(!establishment){cov_22l33pm8ek().b[0][0]++;cov_22l33pm8ek().s[9]++;throw new UnexistenceError(`Establishment with id ${establishmentId} does not exist`);}else{cov_22l33pm8ek().b[0][1]++;}const{staff,tables}=(cov_22l33pm8ek().s[10]++,establishment);const worker=(cov_22l33pm8ek().s[11]++,staff.find(_worker=>{cov_22l33pm8ek().f[2]++;cov_22l33pm8ek().s[12]++;return _worker._id.toString()===workerId;}));cov_22l33pm8ek().s[13]++;if(!worker){cov_22l33pm8ek().b[1][0]++;cov_22l33pm8ek().s[14]++;throw new UnexistenceError(`Worker with id ${workerId} does not exist`);}else{cov_22l33pm8ek().b[1][1]++;}cov_22l33pm8ek().s[15]++;if(!tables.length){cov_22l33pm8ek().b[2][0]++;cov_22l33pm8ek().s[16]++;throw new UnexistenceError('There are no tables yet');}else{cov_22l33pm8ek().b[2][1]++;}cov_22l33pm8ek().s[17]++;return tables;})();};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJldHJpZXZlLXRhYmxlcy5qcyJdLCJuYW1lcyI6WyJtb2RlbHMiLCJFc3RhYmxpc2htZW50IiwiT3JkZXIiLCJyZXF1aXJlIiwiZXJyb3JzIiwiVW5leGlzdGVuY2VFcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiLCJlc3RhYmxpc2htZW50SWQiLCJ3b3JrZXJJZCIsIlN0cmluZyIsInZhbGlkYXRlIiwiZXN0YWJsaXNobWVudCIsImZpbmRCeUlkIiwic3RhZmYiLCJ0YWJsZXMiLCJ3b3JrZXIiLCJmaW5kIiwiX3dvcmtlciIsIl9pZCIsInRvU3RyaW5nIiwibGVuZ3RoIl0sIm1hcHBpbmdzIjoidTJGQWVZOzJGQWZaLEtBQU0sQ0FBQ0EsTUFBTSxDQUFFLENBQUNDLGFBQUQsQ0FBZ0JDLEtBQWhCLENBQVQsMkJBQW1DQyxPQUFPLENBQUMsYUFBRCxDQUExQyxDQUFOLENBQ0EsS0FBTSxDQUFDQyxNQUFNLENBQUUsQ0FBQ0MsZ0JBQUQsQ0FBVCwyQkFBK0JGLE9BQU8sQ0FBQyxnQkFBRCxDQUF0QyxDQUFOLEMsd0JBQ0FBLE9BQU8sQ0FBQyxpQ0FBRCxDQUFQLENBRUE7Ozs7MkJBTUFHLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixDQUFDQyxlQUFELENBQWtCQyxRQUFsQixHQUErQixpREFFNUNDLE1BQU0sQ0FBQ0MsUUFBUCxDQUFnQkgsZUFBaEIsRUFGNEMsd0JBRzVDRSxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JGLFFBQWhCLEVBSDRDLHdCQUs1QyxNQUFPLENBQUMsU0FBVyx5QkFDZixLQUFNRyxDQUFBQSxhQUFhLDBCQUFHLEtBQU1YLENBQUFBLGFBQWEsQ0FBQ1ksUUFBZCxDQUF1QkwsZUFBdkIsQ0FBVCxDQUFuQixDQURlLHdCQUdmLEdBQUcsQ0FBQ0ksYUFBSixDQUFtQix5REFBTSxJQUFJUCxDQUFBQSxnQkFBSixDQUFzQix5QkFBd0JHLGVBQWdCLGlCQUE5RCxDQUFOLENBQXFGLENBQXhHLGlDQUVBLEtBQU0sQ0FBQ00sS0FBRCxDQUFRQyxNQUFSLDRCQUFrQkgsYUFBbEIsQ0FBTixDQUVBLEtBQU1JLENBQUFBLE1BQU0sMkJBQUdGLEtBQUssQ0FBQ0csSUFBTixDQUFXQyxPQUFPLEVBQUksd0RBQUFBLENBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxRQUFaLEtBQTJCWCxRQUEzQixDQUFtQyxDQUF6RCxDQUFILENBQVosQ0FQZSx5QkFTZixHQUFHLENBQUNPLE1BQUosQ0FBWSwwREFBTSxJQUFJWCxDQUFBQSxnQkFBSixDQUFzQixrQkFBaUJJLFFBQVMsaUJBQWhELENBQU4sQ0FBdUUsQ0FBbkYsaUNBVGUseUJBV2YsR0FBRyxDQUFDTSxNQUFNLENBQUNNLE1BQVgsQ0FBbUIsMERBQU0sSUFBSWhCLENBQUFBLGdCQUFKLENBQXFCLHlCQUFyQixDQUFOLENBQXFELENBQXhFLGlDQVhlLHlCQWFmLE1BQU9VLENBQUFBLE1BQVAsQ0FFSCxDQWZNLEdBQVAsQ0FnQkgsQ0FyQkQiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7bW9kZWxzOiB7RXN0YWJsaXNobWVudCwgT3JkZXJ9fSA9IHJlcXVpcmUoJ3FybWVudS1kYXRhJylcbmNvbnN0IHtlcnJvcnM6IHtVbmV4aXN0ZW5jZUVycm9yfX0gPSByZXF1aXJlKCdxcm1lbnUtY29tbW9ucycpXG5yZXF1aXJlKCdxcm1lbnUtY29tbW9ucy9wb2x5ZmlsbHMvc3RyaW5nJylcblxuLyoqXG4gKiBcbiAqIEBwYXJhbSB7c3RyaW5nfSBlc3RhYmxpc2htZW50SWQgaWQgb2YgdGhlIGVzdGFibGlzaG1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSB3b3JrZXJJZCBpZCBvZiB0aGUgd29ya2VyXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSAoZXN0YWJsaXNobWVudElkLCB3b3JrZXJJZCkgPT4ge1xuXG4gICAgU3RyaW5nLnZhbGlkYXRlKGVzdGFibGlzaG1lbnRJZClcbiAgICBTdHJpbmcudmFsaWRhdGUod29ya2VySWQpXG5cbiAgICByZXR1cm4gKGFzeW5jKCkgPT4ge1xuICAgICAgICBjb25zdCBlc3RhYmxpc2htZW50ID0gYXdhaXQgRXN0YWJsaXNobWVudC5maW5kQnlJZChlc3RhYmxpc2htZW50SWQpXG5cbiAgICAgICAgaWYoIWVzdGFibGlzaG1lbnQpIHRocm93IG5ldyBVbmV4aXN0ZW5jZUVycm9yKGBFc3RhYmxpc2htZW50IHdpdGggaWQgJHtlc3RhYmxpc2htZW50SWR9IGRvZXMgbm90IGV4aXN0YClcblxuICAgICAgICBjb25zdCB7c3RhZmYsIHRhYmxlc30gPSBlc3RhYmxpc2htZW50XG5cbiAgICAgICAgY29uc3Qgd29ya2VyID0gc3RhZmYuZmluZChfd29ya2VyID0+IF93b3JrZXIuX2lkLnRvU3RyaW5nKCkgPT09IHdvcmtlcklkKVxuXG4gICAgICAgIGlmKCF3b3JrZXIpIHRocm93IG5ldyBVbmV4aXN0ZW5jZUVycm9yKGBXb3JrZXIgd2l0aCBpZCAke3dvcmtlcklkfSBkb2VzIG5vdCBleGlzdGApXG5cbiAgICAgICAgaWYoIXRhYmxlcy5sZW5ndGgpIHRocm93IG5ldyBVbmV4aXN0ZW5jZUVycm9yKCdUaGVyZSBhcmUgbm8gdGFibGVzIHlldCcpXG5cbiAgICAgICAgcmV0dXJuIHRhYmxlc1xuICAgICAgICBcbiAgICB9KSgpXG59Il19