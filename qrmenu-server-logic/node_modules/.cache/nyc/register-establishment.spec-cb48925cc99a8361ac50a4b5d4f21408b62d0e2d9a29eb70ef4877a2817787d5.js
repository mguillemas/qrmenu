function cov_1s9ozkq278(){var path="/home/marcgm97/bootcamp/collab/skylab-bootcamp-202004/staff/marc-guillemas/qrmenu/qrmenu-server-logic/register-establishment.spec.js";var hash="c2434c3ee360c2e685232c80f8ed22e420ca63ef";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/marcgm97/bootcamp/collab/skylab-bootcamp-202004/staff/marc-guillemas/qrmenu/qrmenu-server-logic/register-establishment.spec.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:26}},"1":{start:{line:3,column:47},end:{line:3,column:54}},"2":{start:{line:5,column:30},end:{line:5,column:65}},"3":{start:{line:6,column:19},end:{line:6,column:23}},"4":{start:{line:7,column:19},end:{line:7,column:34}},"5":{start:{line:8,column:48},end:{line:8,column:73}},"6":{start:{line:9,column:15},end:{line:9,column:34}},"7":{start:{line:10,column:48},end:{line:10,column:70}},"8":{start:{line:12,column:0},end:{line:68,column:2}},"9":{start:{line:13,column:4},end:{line:13,column:47}},"10":{start:{line:13,column:17},end:{line:13,column:46}},"11":{start:{line:17,column:4},end:{line:25,column:5}},"12":{start:{line:18,column:8},end:{line:24,column:14}},"13":{start:{line:20,column:16},end:{line:20,column:50}},"14":{start:{line:21,column:16},end:{line:21,column:36}},"15":{start:{line:22,column:16},end:{line:22,column:48}},"16":{start:{line:23,column:16},end:{line:23,column:48}},"17":{start:{line:27,column:4},end:{line:45,column:6}},"18":{start:{line:28,column:23},end:{line:28,column:87}},"19":{start:{line:30,column:8},end:{line:30,column:38}},"20":{start:{line:32,column:31},end:{line:32,column:57}},"21":{start:{line:34,column:8},end:{line:34,column:49}},"22":{start:{line:36,column:33},end:{line:36,column:47}},"23":{start:{line:38,column:8},end:{line:38,column:68}},"24":{start:{line:39,column:8},end:{line:39,column:48}},"25":{start:{line:40,column:8},end:{line:40,column:61}},"26":{start:{line:42,column:22},end:{line:42,column:86}},"27":{start:{line:44,column:8},end:{line:44,column:32}},"28":{start:{line:47,column:4},end:{line:62,column:6}},"29":{start:{line:48,column:8},end:{line:48,column:87}},"30":{start:{line:48,column:25},end:{line:48,column:86}},"31":{start:{line:50,column:8},end:{line:61,column:10}},"32":{start:{line:51,column:12},end:{line:60,column:13}},"33":{start:{line:52,column:16},end:{line:52,column:80}},"34":{start:{line:54,column:16},end:{line:54,column:62}},"35":{start:{line:56,column:16},end:{line:56,column:38}},"36":{start:{line:58,column:16},end:{line:58,column:56}},"37":{start:{line:59,column:16},end:{line:59,column:85}},"38":{start:{line:64,column:4},end:{line:64,column:47}},"39":{start:{line:64,column:20},end:{line:64,column:46}},"40":{start:{line:67,column:4},end:{line:67,column:38}},"41":{start:{line:67,column:16},end:{line:67,column:37}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:12,column:43},end:{line:12,column:44}},loc:{start:{line:12,column:49},end:{line:68,column:1}},line:12},"1":{name:"(anonymous_1)",decl:{start:{line:13,column:11},end:{line:13,column:12}},loc:{start:{line:13,column:17},end:{line:13,column:46}},line:13},"2":{name:"(anonymous_2)",decl:{start:{line:17,column:15},end:{line:17,column:16}},loc:{start:{line:18,column:8},end:{line:24,column:14}},line:18},"3":{name:"(anonymous_3)",decl:{start:{line:19,column:18},end:{line:19,column:19}},loc:{start:{line:19,column:24},end:{line:24,column:13}},line:19},"4":{name:"(anonymous_4)",decl:{start:{line:27,column:39},end:{line:27,column:40}},loc:{start:{line:27,column:51},end:{line:45,column:5}},line:27},"5":{name:"(anonymous_5)",decl:{start:{line:47,column:50},end:{line:47,column:51}},loc:{start:{line:47,column:56},end:{line:62,column:5}},line:47},"6":{name:"(anonymous_6)",decl:{start:{line:48,column:19},end:{line:48,column:20}},loc:{start:{line:48,column:25},end:{line:48,column:86}},line:48},"7":{name:"(anonymous_7)",decl:{start:{line:50,column:65},end:{line:50,column:66}},loc:{start:{line:50,column:77},end:{line:61,column:9}},line:50},"8":{name:"(anonymous_8)",decl:{start:{line:64,column:14},end:{line:64,column:15}},loc:{start:{line:64,column:20},end:{line:64,column:46}},line:64},"9":{name:"(anonymous_9)",decl:{start:{line:67,column:10},end:{line:67,column:11}},loc:{start:{line:67,column:16},end:{line:67,column:37}},line:67}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c2434c3ee360c2e685232c80f8ed22e420ca63ef"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1s9ozkq278=function(){return actualCoverage;};}return actualCoverage;}cov_1s9ozkq278();cov_1s9ozkq278().s[0]++;require('dotenv').config();const{env:{TEST_MONGODB_URL:MONGODB_URL}}=(cov_1s9ozkq278().s[1]++,process);const registerEstablishment=(cov_1s9ozkq278().s[2]++,require('./register-establishment'));const{random}=(cov_1s9ozkq278().s[3]++,Math);const{expect}=(cov_1s9ozkq278().s[4]++,require('chai'));const{utils:{generateNIF:{generateNIF}}}=(cov_1s9ozkq278().s[5]++,require('qrmenu-commons'));const bcrypt=(cov_1s9ozkq278().s[6]++,require('bcryptjs'));const{models:{Establishment},mongoose}=(cov_1s9ozkq278().s[7]++,require('qrmenu-data'));cov_1s9ozkq278().s[8]++;describe('logic - register establishment',()=>{cov_1s9ozkq278().f[0]++;cov_1s9ozkq278().s[9]++;before(()=>{cov_1s9ozkq278().f[1]++;cov_1s9ozkq278().s[10]++;return mongoose.connect(MONGODB_URL);});let establishment,nif,email,password;cov_1s9ozkq278().s[11]++;beforeEach(()=>{cov_1s9ozkq278().f[2]++;cov_1s9ozkq278().s[12]++;return Establishment.deleteMany().then(()=>{cov_1s9ozkq278().f[3]++;cov_1s9ozkq278().s[13]++;establishment=`name-${random()}`;cov_1s9ozkq278().s[14]++;nif=generateNIF();cov_1s9ozkq278().s[15]++;email=`e-${random()}@mail.com`;cov_1s9ozkq278().s[16]++;password=`password${random()}`;});});cov_1s9ozkq278().s[17]++;it('should succeed on valid data',async()=>{cov_1s9ozkq278().f[4]++;const result=(cov_1s9ozkq278().s[18]++,await registerEstablishment(establishment,nif,email,password));cov_1s9ozkq278().s[19]++;expect(result).to.be.undefined;const establishments=(cov_1s9ozkq278().s[20]++,await Establishment.find());cov_1s9ozkq278().s[21]++;expect(establishments.length).to.equal(1);const[_establishment]=(cov_1s9ozkq278().s[22]++,establishments);cov_1s9ozkq278().s[23]++;expect(_establishment.establishment).to.equal(establishment);cov_1s9ozkq278().s[24]++;expect(_establishment.nif).to.equal(nif);cov_1s9ozkq278().s[25]++;expect(_establishment.staff[0].email).to.equal(email);const match=(cov_1s9ozkq278().s[26]++,await bcrypt.compare(password,_establishment.staff[0].password));cov_1s9ozkq278().s[27]++;expect(match).to.be.true;});cov_1s9ozkq278().s[28]++;describe('when establishment already exists',()=>{cov_1s9ozkq278().f[5]++;cov_1s9ozkq278().s[29]++;beforeEach(()=>{cov_1s9ozkq278().f[6]++;cov_1s9ozkq278().s[30]++;return Establishment.create({establishment,nif,email,password});});cov_1s9ozkq278().s[31]++;it('should fail on trying to register an existing user',async()=>{cov_1s9ozkq278().f[7]++;cov_1s9ozkq278().s[32]++;try{cov_1s9ozkq278().s[33]++;await registerEstablishment(establishment,nif,email,password);cov_1s9ozkq278().s[34]++;throw new Error('should not reach this point');}catch(error){cov_1s9ozkq278().s[35]++;expect(error).to.exist;cov_1s9ozkq278().s[36]++;expect(error).to.be.an.instanceof(Error);cov_1s9ozkq278().s[37]++;expect(error.message).to.equal(`user with nif ${nif} already exists`);}});});cov_1s9ozkq278().s[38]++;afterEach(()=>{cov_1s9ozkq278().f[8]++;cov_1s9ozkq278().s[39]++;return Establishment.deleteMany();});cov_1s9ozkq278().s[40]++;after(()=>{cov_1s9ozkq278().f[9]++;cov_1s9ozkq278().s[41]++;return mongoose.disconnect();});});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlZ2lzdGVyLWVzdGFibGlzaG1lbnQuc3BlYy5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlIiwiY29uZmlnIiwiZW52IiwiVEVTVF9NT05HT0RCX1VSTCIsIk1PTkdPREJfVVJMIiwicHJvY2VzcyIsInJlZ2lzdGVyRXN0YWJsaXNobWVudCIsInJhbmRvbSIsIk1hdGgiLCJleHBlY3QiLCJ1dGlscyIsImdlbmVyYXRlTklGIiwiYmNyeXB0IiwibW9kZWxzIiwiRXN0YWJsaXNobWVudCIsIm1vbmdvb3NlIiwiZGVzY3JpYmUiLCJiZWZvcmUiLCJjb25uZWN0IiwiZXN0YWJsaXNobWVudCIsIm5pZiIsImVtYWlsIiwicGFzc3dvcmQiLCJiZWZvcmVFYWNoIiwiZGVsZXRlTWFueSIsInRoZW4iLCJpdCIsInJlc3VsdCIsInRvIiwiYmUiLCJ1bmRlZmluZWQiLCJlc3RhYmxpc2htZW50cyIsImZpbmQiLCJsZW5ndGgiLCJlcXVhbCIsIl9lc3RhYmxpc2htZW50Iiwic3RhZmYiLCJtYXRjaCIsImNvbXBhcmUiLCJ0cnVlIiwiY3JlYXRlIiwiRXJyb3IiLCJlcnJvciIsImV4aXN0IiwiYW4iLCJpbnN0YW5jZW9mIiwibWVzc2FnZSIsImFmdGVyRWFjaCIsImFmdGVyIiwiZGlzY29ubmVjdCJdLCJtYXBwaW5ncyI6IjR6SkFlWTttSEFmWkEsT0FBTyxDQUFDLFFBQUQsQ0FBUCxDQUFrQkMsTUFBbEIsR0FFQSxLQUFNLENBQUNDLEdBQUcsQ0FBRSxDQUFDQyxnQkFBZ0IsQ0FBRUMsV0FBbkIsQ0FBTiwyQkFBeUNDLE9BQXpDLENBQU4sQ0FFQSxLQUFNQyxDQUFBQSxxQkFBcUIsMEJBQUdOLE9BQU8sQ0FBQywwQkFBRCxDQUFWLENBQTNCLENBQ0EsS0FBTSxDQUFFTyxNQUFGLDJCQUFhQyxJQUFiLENBQU4sQ0FDQSxLQUFNLENBQUVDLE1BQUYsMkJBQWFULE9BQU8sQ0FBQyxNQUFELENBQXBCLENBQU4sQ0FDQSxLQUFNLENBQUVVLEtBQUssQ0FBRSxDQUFDQyxXQUFXLENB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QUFJLDBCQUNBLEtBQU1wQixDQUFBQSxxQkFBcUIsQ0FBQ2EsYUFBRCxDQUFnQkMsR0FBaEIsQ0FBcUJDLEtBQXJCLENBQTRCQyxRQUE1QixDQUEzQixDQURBLHlCQUdBLEtBQU0sSUFBSW1CLENBQUFBLEtBQUosQ0FBVSw2QkFBVixDQUFOLENBQ0gsQ0FBQyxNQUFPQyxLQUFQLENBQWMsMEJBQ1pqQyxNQUFNLENBQUNpQyxLQUFELENBQU4sQ0FBY2QsRUFBZCxDQUFpQmUsS0FBakIsQ0FEWSx5QkFHWmxDLE1BQU0sQ0FBQ2lDLEtBQUQsQ0FBTixDQUFjZCxFQUFkLENBQWlCQyxFQUFqQixDQUFvQmUsRUFBcEIsQ0FBdUJDLFVBQXZCLENBQWtDSixLQUFsQyxFQUhZLHlCQUlaaEMsTUFBTSxDQUFDaUMsS0FBSyxDQUFDSSxPQUFQLENBQU4sQ0FBc0JsQixFQUF0QixDQUF5Qk0sS0FBekIsQ0FBZ0MsaUJBQWdCZCxHQUFJLGlCQUFwRCxFQUNILENBQ0osQ0FYQyxDQUFGLENBWUgsQ0FmTyxDQUFSLENBbkM2Qyx5QkFvRDdDMkIsU0FBUyxDQUFDLElBQU0sd0RBQUFqQyxDQUFBQSxhQUFhLENBQUNVLFVBQWQsR0FBMEIsQ0FBakMsQ0FBVCxDQXBENkMseUJBdUQ3Q3dCLEtBQUssQ0FBQyxJQUFNLHdEQUFBakMsQ0FBQUEsUUFBUSxDQUFDa0MsVUFBVCxHQUFxQixDQUE1QixDQUFMLENBQ0gsQ0F4RE8sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpXG5cbmNvbnN0IHtlbnY6IHtURVNUX01PTkdPREJfVVJMOiBNT05HT0RCX1VSTH19ID0gcHJvY2Vzc1xuXG5jb25zdCByZWdpc3RlckVzdGFibGlzaG1lbnQgPSByZXF1aXJlKCcuL3JlZ2lzdGVyLWVzdGFibGlzaG1lbnQnKVxuY29uc3QgeyByYW5kb20gfSA9IE1hdGhcbmNvbnN0IHsgZXhwZWN0IH0gPSByZXF1aXJlKCdjaGFpJylcbmNvbnN0IHsgdXRpbHM6IHtnZW5lcmF0ZU5JRjoge2dlbmVyYXRlTklGfX0gfSA9IHJlcXVpcmUoJ3FybWVudS1jb21tb25zJylcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdGpzJylcbmNvbnN0IHsgbW9kZWxzOiB7IEVzdGFibGlzaG1lbnQgfSwgbW9uZ29vc2UgfSA9IHJlcXVpcmUoJ3FybWVudS1kYXRhJylcblxuZGVzY3JpYmUoJ2xvZ2ljIC0gcmVnaXN0ZXIgZXN0YWJsaXNobWVudCcsICgpID0+IHtcbiAgICBiZWZvcmUoKCkgPT4gbW9uZ29vc2UuY29ubmVjdChNT05HT0RCX1VSTCkpXG5cbiAgICBsZXQgZXN0YWJsaXNobWVudCwgbmlmLCBlbWFpbCwgcGFzc3dvcmRcblxuICAgIGJlZm9yZUVhY2goKCkgPT4gXG4gICAgICAgIEVzdGFibGlzaG1lbnQuZGVsZXRlTWFueSgpXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgZXN0YWJsaXNobWVudCA9IGBuYW1lLSR7cmFuZG9tKCl9YFxuICAgICAgICAgICAgICAgIG5pZiA9ICBnZW5lcmF0ZU5JRigpXG4gICAgICAgICAgICAgICAgZW1haWwgPSBgZS0ke3JhbmRvbSgpfUBtYWlsLmNvbWBcbiAgICAgICAgICAgICAgICBwYXNzd29yZCA9IGBwYXNzd29yZCR7cmFuZG9tKCl9YFxuICAgICAgICAgICAgfSlcbiAgICApXG5cbiAgICBpdCgnc2hvdWxkIHN1Y2NlZWQgb24gdmFsaWQgZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVnaXN0ZXJFc3RhYmxpc2htZW50KGVzdGFibGlzaG1lbnQsIG5pZiwgZW1haWwsIHBhc3N3b3JkKVxuXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLnVuZGVmaW5lZFxuXG4gICAgICAgIGNvbnN0IGVzdGFibGlzaG1lbnRzID0gYXdhaXQgRXN0YWJsaXNobWVudC5maW5kKClcblxuICAgICAgICBleHBlY3QoZXN0YWJsaXNobWVudHMubGVuZ3RoKS50by5lcXVhbCgxKVxuXG4gICAgICAgIGNvbnN0IFtfZXN0YWJsaXNobWVudF0gPSBlc3RhYmxpc2htZW50c1xuXG4gICAgICAgIGV4cGVjdChfZXN0YWJsaXNobWVudC5lc3RhYmxpc2htZW50KS50by5lcXVhbChlc3RhYmxpc2htZW50KVxuICAgICAgICBleHBlY3QoX2VzdGFibGlzaG1lbnQubmlmKS50by5lcXVhbChuaWYpXG4gICAgICAgIGV4cGVjdChfZXN0YWJsaXNobWVudC5zdGFmZlswXS5lbWFpbCkudG8uZXF1YWwoZW1haWwpXG5cbiAgICAgICAgY29uc3QgbWF0Y2ggPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgX2VzdGFibGlzaG1lbnQuc3RhZmZbMF0ucGFzc3dvcmQpXG5cbiAgICAgICAgZXhwZWN0KG1hdGNoKS50by5iZS50cnVlXG4gICAgfSlcblxuICAgIGRlc2NyaWJlKCd3aGVuIGVzdGFibGlzaG1lbnQgYWxyZWFkeSBleGlzdHMnLCAoKSA9PiB7XG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4gRXN0YWJsaXNobWVudC5jcmVhdGUoeyBlc3RhYmxpc2htZW50LCBuaWYsIGVtYWlsLCBwYXNzd29yZCB9KSlcblxuICAgICAgICBpdCgnc2hvdWxkIGZhaWwgb24gdHJ5aW5nIHRvIHJlZ2lzdGVyIGFuIGV4aXN0aW5nIHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHJlZ2lzdGVyRXN0YWJsaXNobWVudChlc3RhYmxpc2htZW50LCBuaWYsIGVtYWlsLCBwYXNzd29yZClcblxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignc2hvdWxkIG5vdCByZWFjaCB0aGlzIHBvaW50JylcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgZXhwZWN0KGVycm9yKS50by5leGlzdFxuXG4gICAgICAgICAgICAgICAgZXhwZWN0KGVycm9yKS50by5iZS5hbi5pbnN0YW5jZW9mKEVycm9yKVxuICAgICAgICAgICAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50by5lcXVhbChgdXNlciB3aXRoIG5pZiAke25pZn0gYWxyZWFkeSBleGlzdHNgKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pXG5cbiAgICBhZnRlckVhY2goKCkgPT4gRXN0YWJsaXNobWVudC5kZWxldGVNYW55KCkpXG5cblxuICAgIGFmdGVyKCgpID0+IG1vbmdvb3NlLmRpc2Nvbm5lY3QoKSlcbn0pIl19